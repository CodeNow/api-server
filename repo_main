#
# api_repo_main Dockerfile
#
#
# Pull base image.
FROM sandipsingh/api_repo_base
RUN apt-get update 
# Download API-Server Repo
RUN eval $(ssh-agent) > /dev/null && ssh-add /.ssh/id_rsa && git clone git@github.com:CodeNow/api-server.git 

WORKDIR api-server 
RUN npm install 
#RUN make 
RUN npm build 

# Expose port to Host
EXPOSE 3000
# Define default command.
CMD ["NODE_ENV=staging pm2 start server.js -n API-Server", "pm2 logs"]
